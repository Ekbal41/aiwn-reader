<!DOCTYPE html>
<html lang="en">
  <head>
    <title>AIWN Reader - Set API Key</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css"
    />
  </head>
  <body class="d-flex flex-column min-vh-100">
    <!-- Main Content -->
    <main class="container my-5 flex-grow-1 pt-5">
      <div class="form-container mx-auto" style="max-width: 500px">
        {% if error %}
        <div class="alert alert-danger text-center">{{ error }}</div>
        {% endif %}
        <div
          class="d-flex justify-content-between align-items-center mb-3 w-100"
        >
          <h3>Gemini API Key</h3>
          <a href="/" class="btn btn-primary">
            <i class="bi bi-arrow-return-left"></i>
          </a>
        </div>
        <form id="apiKeyForm">
          <div class="mb-3">
            <input
              type="text"
              name="apiKey"
              id="apiKey"
              class="form-control"
              placeholder="Enter your Gemini API key"
              required
            />
          </div>
          <div class="d-grid gap-2">
            <button type="submit" class="btn btn-primary">Save API Key</button>
          </div>
        </form>
        <ol class="mt-4">
          <li>
            <strong>Go to Google AI Studio:</strong>
            <a href="https://aistudio.google.com/" target="_blank"
              >https://aistudio.google.com/</a
            >
          </li>
          <li>
            <strong>Sign In:</strong> Log in using your Google account if you're
            not already signed in.
          </li>
          <li>
            <strong>Accept Terms of Service:</strong> Accept them if prompted on
            first use.
          </li>
          <li>
            <strong>Create or Select a Project:</strong>
            Choose a project to link your API key to.
          </li>
          <li>
            <strong>Go to the API Keys Section:</strong><br />
            Click your profile icon (top right) â†’ Select
            <strong>"API Keys"</strong>.<br />
            Or go directly to:
            <a href="https://aistudio.google.com/app/apikey" target="_blank">
              https://aistudio.google.com/app/apikey
            </a>
          </li>
          <li>
            <strong>Generate API Key:</strong><br />
            Click <strong>"Create API Key"</strong>, then copy and securely
            store your key.
          </li>
        </ol>
      </div>
    </main>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      document.getElementById("apiKey").value =
        localStorage.getItem("geminiApiKey") || ""
      document.getElementById("apiKeyForm").addEventListener("submit", (e) => {
        e.preventDefault()
        const apiKey = document.getElementById("apiKey").value.trim()
        if (apiKey) {
          localStorage.setItem("geminiApiKey", apiKey)
          alert("API key saved successfully!")
          window.location.href = "/"
        } else {
          alert("Please enter a valid API key.")
        }
      })
    </script>
  </body>
</html>
